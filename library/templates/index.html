{% extends "layout.html" %}

{% block headline %}
{% if flag != 'authors_list' and flag != 'authors_by_letter' and flag!= 'publishers_list'  and flag != 'publishers_by_letter' %}
<a class="float-right" href="{{ url_for('main.search_books', flag='books_list') }}" style="text-decoration:none"> üîç
</a>
<a href="{{ url_for('main.home', flag='authors_list')}}" style="text-decoration:none; color:black">Books</a>
<a style="text-decoration:none; color:rgb(9, 145, 9)" href="{{ url_for('book.add_title') }}"> +</a>
<a style="color: red; text-decoration:none" href="{{ url_for('main.search_books') }}">-</a>

{% elif flag == 'authors_list' or flag == 'authors_by_letter' %}
<a class="float-right" href="{{ url_for('main.search_authors', flag='authors_list') }}" style="text-decoration:none"> üîç
</a>
<a href="{{ url_for('main.home', flag='publishers_list')}}" style="text-decoration:none; color:rgb(0, 0, 0)">Authors</a>
<a style="text-decoration:none; color:rgb(9, 145, 9)" href="{{ url_for('author.add_author') }}"> +</a>
<a style="color: red; text-decoration:none" href="{{ url_for('main.search_authors', flag='authors_list') }}">-</a>

{% elif flag == 'publishers_list' or flag == 'publishers_by_letter' %}
<a class="float-right" href="{{ url_for('main.search_publishers', flag='publishers_list') }}"
    style="text-decoration:none"> üîç
</a>
<a href="{{ url_for('main.home', flag='books_list')}}" style="text-decoration:none; color:rgb(0, 0, 0)">Publishers</a>
<a style="text-decoration:none; color:rgb(9, 145, 9)" href="{{ url_for('publisher.add_publisher') }}"> +</a>
<a style="color: red; text-decoration:none" href="{{ url_for('main.search_publishers', flag='publishers_list') }}">-</a>
{% endif %}
{% endblock %}

{%block subhead %}
<hr />
&nbsp;{{ total }} <a style="text-decoration:none; color:cadetblue"
    href="{{ url_for('main.home', flag='books_list') }}">books</a> - {{ total_auth }} <a
    style="text-decoration:none; color:cadetblue" href="{{ url_for('main.home', flag='authors_list') }}">authors</a> -
{{ total_publishers }} <a style="text-decoration:none; color:cadetblue"
    href="{{ url_for('main.home', flag='publishers_list') }}">publishers</a> in Total

<form class="float-right" method="POST" " novalidate>  
    {{ form.csrf_token }}
    {{ form.limit(size=5, class="align-middle mt0") }}
    {{ form.submit(class="btn btn-warning btn-sm align-middle mt0", style="color:black; --bs-btn-font-size: .8rem") }}
</form>

{% endblock subhead %}

{% block a_z %}
{% if flag == 'authors_by_letter' or flag == 'authors_list' %}
{% set url = 'author.authors_by_letter' %}
{% elif flag == 'books_by_letter' or flag == 'books_list' %}
{% set url = 'book.books_by_letter' %}
{% elif flag == 'publishers_by_letter' or flag == 'publishers_list' %}
{% set url = 'publisher.publishers_by_letter' %}
{% endif %}
{% with letter=letter %}
{% include 'a_z.html' %}
{% endwith %}
{% endblock a_z %}

{%block content %}
{% if flag != 'authors_list' and flag != 'authors_by_letter' and flag != 'books_by_letter' and flag!= 'publishers_list' and flag != 'publishers_by_letter' %}
<ul>
    {% if books|count == 0 %}
    <h4 style=" color:red">Library is empty</h4>
    {% else %}
    {% for book in books %}
    <li>
        <button class="btn btn-outline-secondary btn-sm">
            <a href="{{ url_for('book.edit_title', id=book.id) }}"
                style="text-decoration: none; color: darkgray">Edit</a>
        </button>
        <button class="btn btn-outline-danger btn-sm">
            <a href="{{ url_for('book.book_details', id=book.id, book=book) }}"
                style="text-decoration: none; color: orangered">Delete</a>
        </button>&ensp;‚ñ´Ô∏è
        <a style="text-decoration:none" href="{{ url_for('book.book_details', id=book.id) }}">{{ book.title }}</a> -
        {{book.first_publish}} -

        <a style="text-decoration:none"
            href="{{ url_for('author.bibliography', author=book.author) }}">{{ book.author }}</a>
        {% for author in book.authors %}
        {% if author.fullname != book.author %}
        <a style="text-decoration:none" href="{{ url_for('author.bibliography', author=author.fullname) }}">
            {{ '|' }} {{ author.fullname }} {{ '' }}</a>
        {% endif %}
        {% endfor %}

        <a style="font-weight:bolder; text-decoration:none"
            href="{{ url_for('author.bibliography', author=book.author) }}"> -
            {% for author in book.authors %}
            {% if author.fullname == book.author %}
            {{author.books|count}}
            {% endif %}
            {% endfor %}
            books</a> in collection
    </li>
    {% endfor %}
    {% endif %}
    </ul>
    <br />
    {% elif flag == 'authors_list' %}
    <ul>
        {% if authors|count == 0 %}
        <h4 style="color:red">Library is empty</h4>

        {% else %}

        {% for author in authors %}
        <li>
            <button class="btn btn-outline-secondary btn-sm">
                <a href="{{ url_for('author.edit_author', id=author.id) }}"
                    style="text-decoration: none; color: darkgray">Edit</a>
            </button>
            <button class="btn btn-outline-danger btn-sm">
                <a href="{{ url_for('author.author_details', id=author.id) }}"
                    style="text-decoration: none; color: orangered">Delete</a>
            </button>&ensp;‚ñ´Ô∏è
            <a style="text-decoration:none"
                href="{{ url_for('author.author_details', id=author.id) }}">{{ author.fullname}}</a>
            - {{author.born}}-{{author.died}} - {{author.country}} - {{author.city}} -
            <a style="text-decoration:none"
                href="{{ url_for('author.bibliography', author=author.fullname) }}">{{author.books|count}} books</a>
            in
            collection
        </li>
        {% endfor %}
        {% endif %}
    </ul>
    <br />
    {% elif flag == 'authors_by_letter' %}

    <ul>
        {% if authors_by_letter|count == 0 %}
        <h4 style="color:red">Library is empty</h4>

        {% else %}

        {% set auth='authors' if authors_by_letter|count != 1 else 'author' %}
        <h6>{{ authors_by_letter|length }} {{ auth }} found</h6>
       
        {% for author in authors_by_letter %}

        <li>
            <button class="btn btn-outline-secondary btn-sm">
                <a href="{{ url_for('author.edit_author', id=author.id) }}"
                    style="text-decoration: none; color: darkgray">Edit</a>
            </button>
            <button class="btn btn-outline-danger btn-sm">
                <a href="{{ url_for('author.author_details', id=author.id) }}"
                    style="text-decoration: none; color: orangered">Delete</a>
            </button>&ensp;‚ñ´Ô∏è
            <a style="text-decoration:none"
                href="{{ url_for('author.bibliography', author=author.fullname) }}">{{ author.fullname}}</a>
            - {{author.born}}-{{author.died}} - {{author.country}} - {{author.city}} - <a style="text-decoration:none"
                href="{{ url_for('author.bibliography', author=author.fullname) }}">{{author.books|count}} books</a> in
            collection
        </li>
        {% endfor %}
        {% endif %}
    </ul>
    {% elif flag == 'books_by_letter' %}
    <ul>
        {% if books_by_letter|count == 0 %}
        <h4 style="color:red">Library is empty</h4>

        {% else %}

        {% set ttl='books' if books_by_letter|count != 1 else 'book' %}
        <h6>{{ books_by_letter|length }} {{ ttl }} found</h6>

        {% for book in books_by_letter %}
        <li>
            <button class="btn btn-outline-secondary btn-sm">
                <a href="{{ url_for('book.edit_title', id=book.id) }}"
                    style="text-decoration: none; color: darkgray">Edit</a>
            </button>
            <button class="btn btn-outline-danger btn-sm">
                <a href="{{ url_for('book.book_details', id=book.id, book=book) }}"
                    style="text-decoration: none; color: orangered">Delete</a>
            </button>&ensp;‚ñ´Ô∏è
            <a style="text-decoration:none" href="{{ url_for('book.book_details', id=book.id) }}">{{ book.title }}</a> -
            {{book.first_publish}} -

            <a style="text-decoration:none"
                href="{{ url_for('author.bibliography', author=book.author) }}">{{ book.author }}</a>
            {% for author in book.authors %}
            {% if author.fullname != book.author %}
            <a style="text-decoration:none" href="{{ url_for('author.bibliography', author=author.fullname) }}">
                {{ '|' }} {{ author.fullname }} {{ '' }}</a>
            {% endif %}
            {% endfor %}
            <a style="font-weight:bolder; text-decoration:none"
                href="{{ url_for('author.bibliography', author=book.author) }}">
                - {% for author in book.authors %}
                {% if author.fullname == book.author %}
                {{author.books|count}}
                {% endif %}
                {% endfor %} books</a> in collection
        </li>
        {% endfor %}
        {% endif %}
    </ul>
    {% elif flag == 'publishers_list' %}
    <ul>
        {% if publishers|count == 0 %}
        <h4 style="color:red">Library is empty</h4>

        {% else %}

        {% for publisher in publishers %}
        <li>
            <button class="btn btn-outline-secondary btn-sm">
                <a href="{{ url_for('publisher.edit_publisher', id=publisher.id) }}"
                    style="text-decoration: none; color: darkgray">Edit</a>
            </button>
            <button class="btn btn-outline-danger btn-sm">
                <a href="{{ url_for('publisher.publisher_details', id=publisher.id) }}"
                    style="text-decoration: none; color: orangered">Delete</a>
            </button>&ensp;‚ñ´Ô∏è

            {% set auth='author' if publisher.authors|count == 1 else 'authors' %}
            {% set bks='book' if publisher.books|count == 1 else 'books' %}
            <a style="text-decoration:none"
                href="{{ url_for('publisher.publisher_details', id=publisher.id) }}">{{ publisher.publ_name}}</a>
            - {{publisher.publ_est}} - {{publisher.publ_country}} - {{publisher.publ_city}} - <a
                style="text-decoration:none"
                href="{{ url_for('publisher.publisher_authors', publisher=publisher.publ_name) }}">{{ publisher.authors|count }}
                {{ auth }}</a> and <a style="text-decoration:none"
                href="{{ url_for('publisher.publisher_bibliography', publisher=publisher.publ_name)}}">{{ publisher.books|count }}
                {{ bks }}</a>
            in total
        </li>
        {% endfor %}
        {% endif %}
    </ul>
    {% elif flag == 'publishers_by_letter' %}
    <ul>
        {% if publishers_by_letter|count == 0 %}
        <h4 style="color:red">Library is empty</h4>

        {% else %}

        {% set publ='publishers' if publishers_by_letter|count != 1 else 'publisher' %}
        <h6>{{ publishers_by_letter|length }} {{ publ }} found</h6>

        {% for publisher in publishers_by_letter %}
        <li>
            <button class="btn btn-outline-secondary btn-sm">
                <a href="{{ url_for('publisher.edit_publisher', id=publisher.id) }}"
                    style="text-decoration: none; color: darkgray">Edit</a>
            </button>
            <button class="btn btn-outline-danger btn-sm">
                <a href="{{ url_for('publisher.publisher_details', id=publisher.id) }}"
                    style="text-decoration: none; color: orangered">Delete</a>
            </button>&ensp;‚ñ´Ô∏è

            {% set auth='author' if publisher.authors|count == 1 else 'authors' %}
            {% set bks='book' if publisher.books|count == 1 else 'books' %}
            <a style="text-decoration:none"
                href="{{ url_for('publisher.publisher_details', id=publisher.id) }}">{{ publisher.publ_name}}</a>
            - {{publisher.publ_est}} - {{publisher.publ_country}} - {{publisher.publ_city}} - <a
                style="text-decoration:none"
                href="{{ url_for('publisher.publisher_authors', publisher=publisher.publ_name) }}">{{ publisher.authors|count }}
                {{ auth }}</a> and <a style="text-decoration:none"
                href="{{ url_for('publisher.publisher_bibliography', publisher=publisher.publ_name)}}">{{ publisher.books|count }}
                {{ bks }}</a>
            in total
        </li>
        {% endfor %}
        {% endif %}
    </ul>
    {% endif %}
    {% endblock %}